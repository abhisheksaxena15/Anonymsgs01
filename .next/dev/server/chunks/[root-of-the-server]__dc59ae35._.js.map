{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/AnonyMsgs/my-app/src/app/api/auth/%5B...nextauth%5D/options.ts"],"sourcesContent":["import { NextAuthOptions } from \"next-auth\"\r\nimport CredentialsProvider from \"next-auth/providers/credentials\"\r\n// import Facebook from \"next-auth/providers/facebook\" \r\nimport { compare } from \"bcryptjs\"\r\nimport dbConnect from \"@/lib/dbConnect\"\r\nimport User from \"@/model/User\"\r\nimport UserModel from \"@/model/User\"\r\n\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n    providers: [\r\n        CredentialsProvider({\r\n            id: \"credentials\",\r\n            name: \"Credentials\",\r\n            credentials: {\r\n                email: { label: \"Email\", type: \"text\", placeholder: \"jsmith\" },\r\n                password: { label: \"Password\", type: \"password\" }\r\n            },\r\n            // now next auth do not know how to authorize so we will use cust1om authorize function\r\n            async authorize(credentials: any): Promise<any> {\r\n                //cant authorize directly need to connect to db first\r\n                await dbConnect()\r\n                try {\r\n                    const user = await UserModel.findOne({\r\n                        $or: [\r\n                            { email: credentials.identifier },\r\n                            { username: credentials.identifier }\r\n                        ]\r\n                    })\r\n\r\n                    if (!user) {\r\n                        throw new Error(\"No user found with the given email or username\")\r\n                    }\r\n                    if (!user.isVerified) {\r\n                        throw new Error(\"Please verify your account to login\")\r\n                    }\r\n                    const isPasswordCorrect = await bcrypt.compare(credentials.password, user.password)\r\n                    if (!isPasswordCorrect) {\r\n                        throw new Error(\"Incorrect password\")\r\n                    }\r\n                    else { return user }\r\n                } catch (err: any) {\r\n                    throw new Error(err)\r\n                }\r\n            }\r\n\r\n        })\r\n    ],\r\n\r\n    callbacks: {\r\n        async jwt({ token, user}) {\r\n            if (user) {\r\n                token._id = user._id?.tostring();//object id to string\r\n                token._isVerified = user.isVerified;\r\n                token.username = user.username;\r\n                token.isAcceptingMessages = user.isAcceptingMessages;\r\n            }\r\n            return token\r\n        },\r\n        async session({ session,  token }) {\r\n            if (token) {\r\n                session.user._id = token._id \r\n                session.user.isVerified = token.isVerified \r\n                session.user.username = token.username \r\n                session.user.isAcceptingMessages = token.isAcceptingMessages \r\n            return session\r\n        }\r\n\r\n    },\r\n\r\n    pages: {\r\n        signIn: '/sign-in'\r\n    },\r\n    session: {\r\n        strategy: 'jwt'\r\n    },\r\n\r\n    secret: process.env.NEXTAUTH_SECRET\r\n }\r\n}"],"names":[],"mappings":";;;;AACA;;;;;;;;;;;;;;AAQO,MAAM,cAA+B;IACxC,WAAW;QACP,IAAA,kLAAmB,EAAC;YAChB,IAAI;YACJ,MAAM;YACN,aAAa;gBACT,OAAO;oBAAE,OAAO;oBAAS,MAAM;oBAAQ,aAAa;gBAAS;gBAC7D,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACpD;YACA,uFAAuF;YACvF,MAAM,WAAU,WAAgB;gBAC5B,qDAAqD;gBACrD,MAAM;gBACN,IAAI;oBACA,MAAM,OAAO,MAAM,UAAU,OAAO,CAAC;wBACjC,KAAK;4BACD;gCAAE,OAAO,YAAY,UAAU;4BAAC;4BAChC;gCAAE,UAAU,YAAY,UAAU;4BAAC;yBACtC;oBACL;oBAEA,IAAI,CAAC,MAAM;wBACP,MAAM,IAAI,MAAM;oBACpB;oBACA,IAAI,CAAC,KAAK,UAAU,EAAE;wBAClB,MAAM,IAAI,MAAM;oBACpB;oBACA,MAAM,oBAAoB,MAAM,OAAO,OAAO,CAAC,YAAY,QAAQ,EAAE,KAAK,QAAQ;oBAClF,IAAI,CAAC,mBAAmB;wBACpB,MAAM,IAAI,MAAM;oBACpB,OACK;wBAAE,OAAO;oBAAK;gBACvB,EAAE,OAAO,KAAU;oBACf,MAAM,IAAI,MAAM;gBACpB;YACJ;QAEJ;KACH;IAED,WAAW;QACP,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAC;YACpB,IAAI,MAAM;gBACN,MAAM,GAAG,GAAG,KAAK,GAAG,EAAE,YAAW,qBAAqB;gBACtD,MAAM,WAAW,GAAG,KAAK,UAAU;gBACnC,MAAM,QAAQ,GAAG,KAAK,QAAQ;gBAC9B,MAAM,mBAAmB,GAAG,KAAK,mBAAmB;YACxD;YACA,OAAO;QACX;QACA,MAAM,SAAQ,EAAE,OAAO,EAAG,KAAK,EAAE;YAC7B,IAAI,OAAO;gBACP,QAAQ,IAAI,CAAC,GAAG,GAAG,MAAM,GAAG;gBAC5B,QAAQ,IAAI,CAAC,UAAU,GAAG,MAAM,UAAU;gBAC1C,QAAQ,IAAI,CAAC,QAAQ,GAAG,MAAM,QAAQ;gBACtC,QAAQ,IAAI,CAAC,mBAAmB,GAAG,MAAM,mBAAmB;gBAChE,OAAO;YACX;QAEJ;QAEA,OAAO;YACH,QAAQ;QACZ;QACA,SAAS;YACL,UAAU;QACd;QAEA,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACtC;AACD","debugId":null}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///C:/AnonyMsgs/my-app/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";   \r\nimport {authOptions}    from \"./options\";\r\n\r\n\r\nconst handler = NextAuth(authOptions);\r\nexport {handler as GET , handler as POST}; "],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGA,MAAM,UAAU,IAAA,+JAAQ,EAAC,wLAAW","debugId":null}}]
}